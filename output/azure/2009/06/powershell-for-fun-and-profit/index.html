<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

            <!-- Facebook meta tags -->
        <meta property="og:site_name" content="Tyler Butler" />
                    <meta property="og:type" content="article" />
            <meta property="og:url" content="http://www.tylerbutler.com/2009/06/powershell-for-fun-and-profit/" />
            <meta property="og:title" content="PowerShell for Fun and Profit" />
                        
    <title>    PowerShell for Fun and Profit    : Tyler Butler
</title>

    
    <link rel="alternate" type="application/atom+xml"
          title="Tyler Butler Atom Feed"
          href="http://feeds.feedburner.com/TylerButlerAllPosts"/>

                            <link rel="stylesheet" href="/static/bundled/dark_rainbow.53ae7d5e.css" type="text/css"/>
                            
            <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
    <!--suppress JSUnresolvedLibraryURL -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
        if (window.jQuery == undefined) {
                            document.write('<script src="/static/bundled/jquery.8fc25e27.js"><\/script>');
                    }
    </script>

        <!--suppress JSUnresolvedLibraryURL -->
    <script type="text/javascript"
            src="//use.typekit.net/vty2qol.js"></script>
    <script type="text/javascript">
        try {
            // noinspection JSUnresolvedVariable
            Typekit.load();
        }
        catch (e) {
        }
    </script>

    
    
            <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26061862-1']);
    _gaq.push(['_setDomainName', 'tylerbutler.com']);

    // track speed for all users; traffic is low enough this shouldn't be a problem
    _gaq.push(['_setSiteSpeedSampleRate', 100]);
    
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>    
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body class=""><!--[if lt IE 7]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->                        <div id="fb-root"></div>
            <script>(function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) {
                    return;
                }
                js = d.createElement(s);
                js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=298536070167430&version=v2.0";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));</script>
                <div class="container">            <header id="primary" class="row">                                            <h1 class="small-12 medium-5 columns">
                            <a href="/">                                    tyler
                                    <span class="highlight">butler</span>
                                </a>
                        </h1>
                                                        <nav class="small-12 medium-7 columns">                            <ul class="nav navbar-nav">
    
                <li class="current">
        <a href="/">articles</a></li>
                <li>
        <a href="/projects">projects</a></li>
</ul>

                        </nav>
                </header>
        <div class="row">                <section id="main"
                         class="twelve columns"
                         role="main">    <div class="row">
            <div class="post-info medium-3 large-2 columns">
            <div class="post-date">
                                    <div class="month">JUN</div>
                    <div class="day">15</div>
                    <div class="year">2009</div>
                    <div class="permalink">
                        <a href="/2009/06/powershell-for-fun-and-profit/"
                           title="Permanent link to 'PowerShell for Fun and Profit'">∞</a>
                    </div>
                            </div>
                                        <ul class="tags">
                                            <li><a href="/tag/powershell">powershell</a>
                        </li>
                                            <li><a href="/tag/sharepoint">sharepoint</a>
                        </li>
                                    </ul>
                                        <div class="sharing hide-for-small-only">
                                            <div>
    <a href="https://twitter.com/share" class="twitter-share-button"
       data-text="PowerShell for Fun and Profit"
                   data-via="tylerbutler"
       data-related="tylerbutler"
                   data-url="http://www.tylerbutler.com/2009/06/powershell-for-fun-and-profit/"
       data-count="none"
       data-dnt="true">
        Tweet
    </a>
</div>
<script>!function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = p + '://platform.twitter.com/widgets.js';
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, 'script', 'twitter-wjs');</script>                    
                                            <div>
    <div class="fb-share-button"
         data-href="http://www.tylerbutler.com/2009/06/powershell-for-fun-and-profit/"
         data-layout="button">
    </div>
</div>                                    </div>
                    </div>
    
                        <article class="post-content medium-9 large-10 columns">
                <time datetime="2009-06-15 PDT"
                      pubdate=""></time>
                <header>
                    <h1>
                        <a href="        /2009/06/powershell-for-fun-and-profit/">PowerShell for Fun and Profit</a>
                                            </h1>
                </header>
                                    <p>Stefan Goßner has a great post on his blog covering <a href="http://blogs.technet.com/stefan_gossner/pages/content-deployment-best-practices.aspx">some common problems</a>
that people have with Content Deployment in SharePoint. Problem 13 has to do
with the default timeout window for Content Deployment jobs. Stefan provides
some sample code that you can use to adjust the timeout value, since it&#8217;s not
exposed through the <span class="caps">UI</span>, but I find writing and running sample code on a server
a bit of a pain. Instead of writing code, you can actually use PowerShell to
do this directly from the <span class="caps">PS</span>&nbsp;prompt.</p>
<p>The key to doing this is loading the SharePoint DLLs into your PowerShell
environment. You can do this using the System.Reflection.Assembly class. Take
a look at this sample&nbsp;script:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span class="k">param</span><span class="p">(</span> <span class="nv">$newTimeout</span> <span class="p">=</span> <span class="n">600</span> <span class="p">)</span>

<span class="no">[System.Reflection.Assembly]</span><span class="p">::</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;Microsoft.SharePoint.Publishing, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c&quot;</span><span class="p">)</span>

<span class="nv">$cdconfig</span> <span class="p">=</span> <span class="no">[Microsoft.SharePoint.Publishing.Administration.ContentDeploymentConfiguration]</span><span class="p">::</span><span class="n">GetInstance</span><span class="p">()</span>

<span class="nv">$cdconfig</span><span class="p">.</span><span class="n">RemoteTimeout</span> <span class="p">=</span> <span class="nv">$newTimeout</span>
<span class="nv">$cdconfig</span><span class="p">.</span><span class="n">Update</span><span class="p">()</span>

<span class="s2">&quot;Updated RemoteTimeout to $newTimeout seconds.&quot;</span>
</pre></div>
</td></tr></table>

<p>In line 3, I load up the Microsoft.SharePoint.Publishing <span class="caps">DLL</span>, then I grab the
<code>ContentDeploymentConfiguration</code> (line 5) using the <code>GetInstance()</code> static method.
I update the <code>RemoteTimeout</code> property, then call <code>Update()</code>, and we&#8217;re done. No
code to write and&nbsp;compile.</p>
<p>This example uses the param keyword, which means you can save it as
<code>ChangeRemoteTimeout.ps1</code>, then run it like&nbsp;this:</p>
<div class="codehilite"><pre>PS C:\&gt; ChangeRemoteTimeout –newTimeout 1200
</pre></div>


<p>This is completely optional, of course, but if you find yourself doing this a
lot, it might be worth saving it as a reusable&nbsp;script.</p>
<p>You might also want to make changes to some of the options that are exposed
through the <span class="caps">UI</span> already. Here&#8217;s an&nbsp;example:</p>
<div class="codehilite"><pre><span class="x"><span class="caps">PS</span> C:\&gt; [System.Reflection.Assembly]::Load(&quot;Microsoft.SharePoint.Publishing, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c&quot;)</span>
<span class="x"><span class="caps">PS</span> C:\&gt; </span><span class="p">$</span><span class="nv">cdconfig</span><span class="x"> = [Microsoft.SharePoint.Publishing.Administration.ContentDeploymentConfiguration]::GetInstance()</span>
<span class="x"><span class="caps">PS</span> C:\&gt; </span><span class="p">$</span><span class="nv">cdconfig</span><span class="p">.</span><span class="nv">AcceptIncomingJobs</span><span class="x"> = </span><span class="p">$</span><span class="nv">true</span><span class="x"></span>
<span class="x"><span class="caps">PS</span> C:\&gt; </span><span class="p">$</span><span class="nv">cdconfig</span><span class="p">.</span><span class="nv">RequiresSecureConnection</span><span class="x"> = </span><span class="p">$</span><span class="nv">false</span><span class="x"></span>
<span class="x"><span class="caps">PS</span> C:\&gt; </span><span class="p">$</span><span class="nv">cdconfig</span><span class="p">.</span><span class="nv">Update</span><span class="p">()</span><span class="x"></span>
</pre></div>


<p>In this case, I&#8217;m configuring the farm to accept incoming deployment jobs and
not require secure connections. You can also make additional changes to other
properties, such as FileMaxSize and RemotePollingInterval using this method.
Stefan covers these properties in his <a href="http://blogs.technet.com/stefan_gossner/archive/2008/05/28/pimp-my-content-deployment-job.aspx">Pimp My Content Deployment Job</a>&nbsp;post.</p>
<p>One other note&#8230; Using .<span class="caps">NET</span> DLLs in PowerShell is generally supported across
the board. It&#8217;s not limited to the SharePoint DLLs. There&#8217;s some pretty
exciting stuff you can do here once you start playing&nbsp;around.</p>
                                                                                                                
                    <div class="row">
                        <div class="small-12 columns post-links">
                            <ul class="row">
                                <li class="small-12 medium-6 columns text-left">
                                                                            <a href="/2009/05/who-watches-the-watchman/">← Who Watches the Watchman?</a>
                                                                    </li>
                                <li class="small-12 medium-6 columns text-right">
                                                                            <a href="/2009/06/effing-hail/">Effing Hail →</a>
                                                                    </li>
                            </ul>
                        </div>
                    </div>
                                                    <section id="comments">
                                                    <header>
                                <h1>Comments</h1>
                            </header>
                                                    <div id="disqus_thread"></div>
    <!-- DISQUS -->
    <script type="text/javascript">
        var disqus_shortname = 'tylerbutlercom';
        var disqus_identifier = '/2009/06/powershell-for-fun-and-profit/';
        var disqus_url = 'http://www.tylerbutler.com/2009/06/powershell-for-fun-and-profit/';
        
        (function () {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments
        powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span
            class="logo-disqus">Disqus</span></a>
                    </section>
                            </article>
            </div></section>
            </div>
        <div class="row">                <footer class="small-12 small-centered columns">                        <p>&copy; 2002-2015 Tyler Butler. All rights reserved.</p>

<p>Powered by <a href="http://www.tylerbutler.com/projects/engineer">engineer</a>.</p>                    </footer>
            </div>
    </div>
            <script src="/static/bundled/foundation.2c7a7f9a.js"></script>
        
</body>
</html>