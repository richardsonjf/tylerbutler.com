<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

            <!-- Facebook meta tags -->
        <meta property="og:site_name" content="Tyler Butler" />
                    <meta property="og:type" content="article" />
            <meta property="og:url" content="http://www.tylerbutler.com/2004/10/fun-with-text-to-speech/" />
            <meta property="og:title" content="Fun With Text-to-Speech" />
                        
    <title>    Fun With Text-to-Speech    : Tyler Butler
</title>

    
    <link rel="alternate" type="application/atom+xml"
          title="Tyler Butler Atom Feed"
          href="http://feeds.feedburner.com/TylerButlerAllPosts"/>

                            <link rel="stylesheet" href="/static/bundled/dark_rainbow.53ae7d5e.css" type="text/css"/>
                            
            <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
    <!--suppress JSUnresolvedLibraryURL -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
        if (window.jQuery == undefined) {
                            document.write('<script src="/static/bundled/jquery.8fc25e27.js"><\/script>');
                    }
    </script>

        <!--suppress JSUnresolvedLibraryURL -->
    <script type="text/javascript"
            src="//use.typekit.net/vty2qol.js"></script>
    <script type="text/javascript">
        try {
            // noinspection JSUnresolvedVariable
            Typekit.load();
        }
        catch (e) {
        }
    </script>

    
    
            <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26061862-1']);
    _gaq.push(['_setDomainName', 'tylerbutler.com']);

    // track speed for all users; traffic is low enough this shouldn't be a problem
    _gaq.push(['_setSiteSpeedSampleRate', 100]);
    
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>    
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body class=""><!--[if lt IE 7]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->                        <div id="fb-root"></div>
            <script>(function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) {
                    return;
                }
                js = d.createElement(s);
                js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=298536070167430&version=v2.0";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));</script>
                <div class="container">            <header id="primary" class="row">                                            <h1 class="small-12 medium-5 columns">
                            <a href="/">                                    tyler
                                    <span class="highlight">butler</span>
                                </a>
                        </h1>
                                                        <nav class="small-12 medium-7 columns">                            <ul class="nav navbar-nav">
    
                <li class="current">
        <a href="/">articles</a></li>
                <li>
        <a href="/projects">projects</a></li>
</ul>

                        </nav>
                </header>
        <div class="row">                <section id="main"
                         class="twelve columns"
                         role="main">    <div class="row">
            <div class="post-info medium-3 large-2 columns">
            <div class="post-date">
                                    <div class="month">OCT</div>
                    <div class="day">15</div>
                    <div class="year">2004</div>
                    <div class="permalink">
                        <a href="/2004/10/fun-with-text-to-speech/"
                           title="Permanent link to 'Fun With Text-to-Speech'">∞</a>
                    </div>
                            </div>
                                        <ul class="tags">
                                            <li><a href="/tag/snippets">snippets</a>
                        </li>
                                            <li><a href="/tag/c">C#</a>
                        </li>
                                    </ul>
                                        <div class="sharing hide-for-small-only">
                                            <div>
    <a href="https://twitter.com/share" class="twitter-share-button"
       data-text="Fun With Text-to-Speech"
                   data-via="tylerbutler"
       data-related="tylerbutler"
                   data-url="http://www.tylerbutler.com/2004/10/fun-with-text-to-speech/"
       data-count="none"
       data-dnt="true">
        Tweet
    </a>
</div>
<script>!function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = p + '://platform.twitter.com/widgets.js';
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, 'script', 'twitter-wjs');</script>                    
                                            <div>
    <div class="fb-share-button"
         data-href="http://www.tylerbutler.com/2004/10/fun-with-text-to-speech/"
         data-layout="button">
    </div>
</div>                                    </div>
                    </div>
    
                        <article class="post-content medium-9 large-10 columns">
                <time datetime="2004-10-15 PDT"
                      pubdate=""></time>
                <header>
                    <h1>
                        <a href="        /2004/10/fun-with-text-to-speech/">Fun With Text-to-Speech</a>
                                            </h1>
                </header>
                                    <p>At work, we have a mindless task that has to be done manually every hour.
Basically, we have to log into this website and click around a bit to make
sure that the site is still up and running. It&#8217;s pretty ridiculous, I know,
but it has to be done nonetheless. No one in the office ever remembers to do
it, so I decided it might be nice to have an alarm of sorts. So I remembered
some of my old Micrososft Agent tinkering back in High School, and looked
around for some examples of using the <a href="http://www.microsoft.com/speech/download/sdk51/">Windows speech <span class="caps">API</span></a> in C#. It didn&#8217;t
take me long to figure it out, and the code for my simple text-to-speech
program is deceptively simple. Instead of providing the code as a download,
I&#8217;m just posting it here since it is so&nbsp;short.</p>
<div class="codehilite"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">SpeechLib</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Speak</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Speak</span>
    <span class="p">{</span>
        <span class="c1">///</span>
        <span class="c1">/// The main entry point for the application.</span>
        <span class="c1">///  [STAThread]</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">SpeechVoiceSpeakFlags</span> <span class="n">flags</span> <span class="p">=</span> <span class="n">SpeechVoiceSpeakFlags</span><span class="p">.</span><span class="n">SVSFlagsAsync</span><span class="p">;</span>
            <span class="n">SpVoice</span> <span class="n">v</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SpVoice</span><span class="p">();</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">args</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">v</span><span class="p">.</span><span class="n">Speak</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">flags</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">v</span><span class="p">.</span><span class="n">Speak</span><span class="p">(</span><span class="s">&quot;Please specify what you would like me to say.&quot;</span><span class="p">,</span> <span class="n">flags</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="n">v</span><span class="p">.</span><span class="n">WaitUntilDone</span><span class="p">(</span><span class="n">Timeout</span><span class="p">.</span><span class="n">Infinite</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Basically all you need is the code above and the Interop.SpeechLib.dll file,
which provides access to the speech utilities. For completeness (and since I
had some trouble finding the <span class="caps">DLL</span>), I put a copy of the file up on here.
This program basically just echoes back whatever string you pass in at the
command line, so to get the scheduling working, I just used Windows Task
Scheduler. I scheduled a task to run every hour ever day between 8am and 10pm
(check the advanced settings of the Task Scheduler), then pointed the task to
the compiled program, passing it the string I want it to say as the argument.
Simple. And it works. I still smile every time one of the office computers
says, &#8220;It is time to check&nbsp;Blackboard.&#8221;</p>
                                                                                                                
                    <div class="row">
                        <div class="small-12 columns post-links">
                            <ul class="small-block-grid-2">
                                <li>
                                                                            <a href="/2004/09/getting-rich/">← Getting Rich</a>
                                                                    </li>
                                <li>
                                                                            <a href="/2004/10/ode-to-the-nice-guys/">Ode to the Nice Guys →</a>
                                                                    </li>
                            </ul>
                        </div>
                    </div>
                                                    <section id="comments">
                                                    <header>
                                <h1>Comments</h1>
                            </header>
                                                    <div id="disqus_thread"></div>
    <!-- DISQUS -->
    <script type="text/javascript">
        var disqus_shortname = 'tylerbutlercom';
        var disqus_identifier = '/2004/10/fun-with-text-to-speech/';
        var disqus_url = 'http://www.tylerbutler.com/2004/10/fun-with-text-to-speech/';
        
        (function () {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments
        powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span
            class="logo-disqus">Disqus</span></a>
                    </section>
                            </article>
            </div></section>
            </div>
        <div class="row">                <footer class="small-12 small-centered columns">                        <p>&copy; 2002-2015 Tyler Butler. All rights reserved.</p>

<p>Powered by <a href="http://www.tylerbutler.com/projects/engineer">engineer</a>.</p>                    </footer>
            </div>
    </div>
            <script src="/static/bundled/foundation.2c7a7f9a.js"></script>
        
</body>
</html>